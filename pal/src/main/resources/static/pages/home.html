
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>home page</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link rel="stylesheet" type="text/css" href="css/animate.css">
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/flatpickr.min.css">
		<link rel="stylesheet" type="text/css" href="css/line-awesome.css">
		<link rel="stylesheet" type="text/css" href="css/line-awesome-font-awesome.min.css">
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
		<link rel="stylesheet" type="text/css" href="lib/slick/slick.css">
		<link rel="stylesheet" type="text/css" href="lib/slick/slick-theme.css">
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<link rel="stylesheet" type="text/css" href="css/responsive.css">
		<link rel="stylesheet" type="text/css" href="css/index.css">
		<link rel="stylesheet" type="text/css" href="css/radio.css" />
		<link rel="stylesheet" type="text/css" href="css/message.css" />
		<style>
			#gallery { overflow: hidden; }
			#gallery a { display: block; float: left; }
			#gallery-recharge { overflow: hidden; }
			#gallery-recharge a { display: block; float: left; }
		</style>
	</head>
	
	<body>

		<div class="wrapper" id="app">
			<!-- 头部--------------------start -->
			<header>
				<div class="container">
					<div class="header-data">
						<div class="logo">
							<a href="index.html" title=""><img src="images/logo.png" alt=""></a>
						</div><!--logo end-->
						<div class="search-bar">
						
						</div><!--search-bar end-->
						<nav>
							<ul>
								<li>
									<a @click="logout" title="" class="not-box-open">
										<span><img src="images/icon7.png" alt=""></span>
										{{topLabel[2]}}
									</a>
								</li>
							</ul>
						</nav><!--nav end-->
						<div class="menu-btn">
							<a href="#" title=""><i class="fa fa-bars"></i></a>
						</div><!--menu-btn end-->
						<div class="user-account">
							<div class="user-info" style="width: 150px;">
								<select style="background: #E44D3A;border: none;color: white;" 
								class="form-control form-control-lg language" v-model="languageID" @click="change">
									<option selected="true" value="1">中文简体</option>
									<option value="2">中文-繁體</option>
									<option value="3">English</option>
									<option value="4">한국어</option>
									<option value="5">にほんご</option>
									<option value="6">ภาษาไทย</option>
								</select>
							</div>
						</div>
					</div><!--header-data end-->
				</div>
			</header><!--header end-->	
			<!-- 头部--------------------end -->
			

			
			<main>
				<div class="main-section">
					<div class="container">
						<div class="main-section-data">
							<div class="row">
								<!-- 左侧栏------------------------start -->
								<div class="col-lg-3">
									<div class="main-left-sidebar">
										<div class="user_profile">
											<div class="user-pro-img">
												<template v-if="user.headStatus==1">
													<img :src="headLink" alt="" width="170px" height="170px">
												</template>
												<template v-else>
													<img :src="user.headLink" alt="" width="170px" height="170px">
												</template>
											</div><!--user-pro-img end-->
											<div class="user-tab-sec">
												<h3>{{user.username}}</h3>
											</div>
											<div class="user_pro_status row" v-if="threadUser.id != user.id">
												<div class="col-6" style="justify-content: center;">
													<div>
														<button class="btn" @click="toMessageView(user.username, user.id)" style="background-color:#53d690;">
															<img src="images/envelop.png" alt="" height="20px">
														</button>
													</div>
												</div>
												<div class="col-6" style="justify-content: center;">
													<div>
														<button class="btn" style="background-color:#53d690;">
															<img src="images/video.png" alt="" height="20px">
														</button>
													</div>
												</div>
											</div>
											<!-- 信息栏---------------------start -->
											<ul class="social_links" v-if="userInfo.view">
												<li><a href="#" title="">{{leftLabel[3]}} ：{{userInfo.view.birthday}}</a></li>
												<li><a href="#" title="">{{leftLabel[4]}} ：{{userInfo.view.info.education}}</a></li>
												<li><a href="#" title="">{{leftLabel[5]}} ：{{userInfo.view.info.height}}</a></li>
												<li><a href="#" title="">{{leftLabel[6]}} ：{{userInfo.view.info.weight}}</a></li>
												<li><a href="#" title="">{{leftLabel[7]}} ：{{userInfo.view.info.job}}</a></li>
												<li><a href="#" title="">{{leftLabel[8]}} ：{{userInfo.view.info.country}}</a></li>
												<li><a href="#" title="">{{leftLabel[9]}} ：{{userInfo.view.info.town}}</a></li>
											</ul>
											<!-- 信息栏---------------------end -->
										</div><!--user_profile end-->
										
									</div><!--main-left-sidebar end-->
								</div>
								<!-- 左侧栏------------------------end -->
								
								<!-- 右侧栏------------------start -->
								<div class="col-lg-9">
									<div class="main-ws-sec">
										
										<div class="tab-feed st2">
												<ul>
													<!-- 动态----------start -->
													<li data-tab="feed-dd" v-bind:class="{ active: (1 == tempIndex) }">
														<a @click="getLaterDynamic(1)" title="">
															<img src="images/ic1.png" alt="">
															<span>{{rightLabel[0]}}</span>
														</a>
													</li>
													<!-- 动态----------end -->
													<!-- 发送的礼物---------start -->
													<li data-tab="send-dd" v-bind:class="{ active: (2 == tempIndex) }"  v-if="threadUser.id == user.id">
														<a @click="getSendGiftOrder(2)" title="">
															<img src="images/ic6.png" alt="">
															<span>{{rightLabel[1]}}</span>
														</a>
													</li>
													<!-- 发送的礼物----------end -->
													
													<!-- 接受的礼物---------start -->
													<li data-tab="take-dd" v-bind:class="{ active: (3 == tempIndex) }" v-if="threadUser.id == user.id">
														<a @click="getTakeGiftOrder(3)" title="">
															<img src="images/ic6.png" alt="">
															<span>{{rightLabel[2]}}</span>
														</a>
													</li>
													<!-- 接受的礼物----------end -->
												</ul>
											</div><!-- tab-feed end-->
										</div>
										
										<!-- 动态--------------------start -->
										<div class="product-feed-tab" id="feed-dd" v-bind:class="{ current: (1 == tempIndex) }">
											<div class="posts-section" v-if="dynamics.data.length>0">
												
												<div class="post-bar" v-for="(item, index) in dynamics.data">
													<div class="post_topbar">
														<div class="usy-dt">
															<template v-if="item.view.user.headStatus == 1">
																<img :src="headLink" alt="" width="50px" height="50px" >
															</template>
															<template v-else>
																<img :src="item.view.user.headLink" alt="" width="50px" height="50px">
															</template>
															<div class="usy-name">
																<h3>{{item.view.user.username}}</h3>
																<span><img src="images/clock.png" alt="">{{item.view.createDate}}</span>
															</div>
														</div>
													</div>
													
													<div class="job_descp">
														<p>
															{{item.view.dynamic.content}} 
														</p>
													</div>
													<template v-if="item.view.dynamic.image != ''">
														<img :src="item.view.dynamic.image" width="300px" style="margin:10px 0 10px 10px"/>
													</template>
												</div><!--post-bar end-->
												<div class="process-comm">
													<a href="#" title=""><img src="images/process-icon.png" alt=""></a>
												</div><!--process-comm end-->
											</div><!--posts-section end-->
										</div><!--product-feed-tab end-->
										<!-- 动态---------------------end -->
										<!-- 发送的礼物---------start -->
										<div class="product-feed-tab" id="send-dd" v-bind:class="{ current: (2 == tempIndex) }">
											<div class="list-group" v-if="sendGiftOrder.length > 0">
												<a class="list-group-item list-group-item-action" v-for="(item, index) in sendGiftOrder">
													<div class="row" style="align-items: center;">
														<span>{{item.view.createDate}}</span>
													</div>
													<div class="row" style="align-items: center;margin-top: 5px;">
														<div class="col-6" style="padding-left: 0px;">
															<img :src="item.view.gift.path" height="50px" width="50px" />
														</div>
														<div class="col-6">
															<span style="color: #51a5fb;">{{item.view.toUser.username}}</span>
														</div>
													</div>
													<div class="row" style="align-items: center;margin-top: 5px;">
														<div class="col-6">
															<span style="color: #51a5fb;">{{item.view.giftOrder.price}}</span>
														</div>
														<div class="col-6">
															<span style="color: #51a5fb;">{{item.view.giftOrder.num}}</span>
														</div>
													</div>
													<div class="row" style="align-items: center;margin-top: 5px;">
														<span>{{item.view.giftOrder.content}}</span>
													</div>
												</a>
											</div>
										</div>
										<!-- 发送的礼物----------end -->
										
										<!-- 接受的礼物---------start -->
										<div class="product-feed-tab" id="take-dd" v-bind:class="{ current: (3 == tempIndex) }">
											<div class="list-group" v-if="takeGiftOrder.length > 0">
												<a class="list-group-item list-group-item-action" v-for="(item, index) in takeGiftOrder">
													<div class="row" style="align-items: center;">
														<span>{{item.view.createDate}}</span>
													</div>
													<div class="row" style="align-items: center;margin-top: 5px;">
														<div class="col-6" style="padding-left: 0px;">
															<img :src="item.view.gift.path" height="50px" width="50px" />
														</div>
														<div class="col-6">
															<span style="color: #51a5fb;">{{item.view.giftOrder.username}}</span>
														</div>
													</div>
													<div class="row" style="align-items: center;margin-top: 5px;">
														<div class="col-6" >
															<span style="color: #51a5fb;">{{item.view.giftOrder.price}}</span>
														</div>
														<div class="col-6">
															<span style="color: #51a5fb;">{{item.view.giftOrder.num}}</span>
														</div>
													</div>
													<div class="row" style="align-items: center;margin-top: 5px;">
														<span>{{item.view.giftOrder.content}}</span>
													</div>
												</a>
											</div>
										</div>
										<!-- 接受的礼物----------end -->
									</div><!--main-ws-sec end-->
								</div>
								<!-- 右侧栏------------------end -->
								
							</div>
						</div><!-- main-section-data end-->
					</div> 
				</div>
			</main>
			
			<!-- 底部---------------------start -->
			<footer>
				<div class="footy-sec mn no-margin">
					<div class="container">
						<ul>
							<li><a href="#" title="">Help Center</a></li>
							<li><a href="#" title="">Privacy Policy</a></li>
							<li><a href="#" title="">Community Guidelines</a></li>
							<li><a href="#" title="">Cookies Policy</a></li>
							<li><a href="#" title="">Career</a></li>
							<li><a href="#" title="">Forum</a></li>
							<li><a href="#" title="">Language</a></li>
							<li><a href="#" title="">Copyright Policy</a></li>
						</ul>
						<p><img src="images/copy-icon2.png" alt="">Copyright 2017</p>
						<img class="fl-rgt" src="images/logo2.png" alt="">
					</div>
				</div>
			</footer>
			<!-- 底部---------------------end -->
			
			<div class="message">
				<div class="row" style="background: #E44D3A;display: flex;justify-content: space-between;padding: 5px 10px;">
					<div>
						<span style="color:white;">{{messageUsername}}</span>
					</div>
					<div>
						<span style="color:white;" @click="closeMessageView">Ｘ</span>
					</div>
				</div>
				<div class="row" style="padding: 5px;">
					<textarea class="form-control" v-model="messageContent" id="exampleFormControlTextarea1" rows="3"></textarea>
				</div>
				<div class="row" style="display: flex;justify-content: center;padding: 0 5px;">
					<button type="button" class="btn btn-success btn-lg btn-block" @click="sendMessage">发送</button>
				</div>
			</div>
		</div>
		
	</body>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/popper.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/flatpickr.min.js"></script>
	<script type="text/javascript" src="lib/slick/slick.min.js"></script>
	<script type="text/javascript" src="js/script.js"></script>
	<script src="js/vue-2.4.0.js"></script>
	<script src="js/vue-resource-1.3.4.js"></script>
	<script src="pop/js/jquery.poptrox.min.js"></script>
	<script src="js/browser.min.js"></script>
	<script src="js/polyfill.min.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/babel">
		var vm = new Vue({
			el : '#app',
			data:{
				
				/* 令牌-------------start  */
				ticket:"",
				/* 令牌-------------end  */
				threadUser:"",
				/* 个人信息----------------start */
				userID:"",
				user:"",
				userInfo:"",
				headLink:"images/user/default.png",
				/* 个人信息----------------end */
				
				/* 消息-----start */
				messageContent:"",
				messageToUserID:0,
				messageUsername:"",
				/* 消息-----end */
				
				/* 动态---------------start */
				dynamics:{
					data:[],
				},
				/* 动态----------end */
				
				/* 发送的礼物-----------start */
				sendGiftOrder:[],
				/* 发送的礼物-----------end */
				
				/* 接受的礼物-----------start */
				takeGiftOrder:[],
				/* 接受的礼物-----------end */
				
				tempIndex:1,
				
				/* 标签---------------------start */
				languageID:1,
				topLabel:["个人资料", "消息", "退出"],
				leftLabel:["升级", "充值", "金币", "生日", "教育", "身高", "体重", "工作", "国家", "地区"],
				rightLabel:["动态", "发送的礼物", "接受的礼物"],
				formLabel:["选择图片", "发布"]
				/* 标签---------------------end */
			},
			methods:{
				toMessageView(username, toUserID) {
					this.messageToUserID = toUserID
					this.messageUsername = username
					$('.bgPop,.message').show();
					console.log("用户名" + this.messageUsername)
				},
				closeMessageView() {
					$('.bgPop,.message').hide();
					this.messageToUserID = 0
					this.messageUsername = ""
					this.messageContent = ""
				},
				sendMessage() {
					if(this.messageContent == "") {
						return
					}
					var formData = new FormData();
					formData.append('content', this.messageContent);
					formData.append('toUserID', this.messageToUserID);
					this.$http.post('/user/addMessage/', formData).
					then(function (res) {
						if(res.body.eor){
							alert(res.body.eor)
						}
						if(res.body.member) {
							this.toView(1)
							return ;
						}
						this.closeMessageView()
					}, function (res) {
					  console.log(res.body);
					});
				},
				checkTicket() {
					this.ticket = localStorage.getItem("ticket");
					if(this.ticket == "") {
						window.location.href = "login.html"
						return 
					}
				},
				getThreadUser() {
					this.$http.get('/user/getUserInfo/',{header:{cookie:this.ticket}},
					{params : {time:new Date().getTime()}})
					.then(function(res) {
						this.toLoginView(res)
						this.threadUser = res.body.user
					},function() {
						console.log('请求失败处理');
					});
				},
				//获取用户信息
				getUserInfo() {
					this.$http.get('/user/getUserInfoByID/',
					{params : {id:this.userID, time:new Date().getTime()}},{header : {cookie:this.ticket}})
					.then(function(res) {
						this.toLoginView(res)
						this.userInfo = res.body.userInfo
						this.user = res.body.user
					},function() {
						console.log('请求失败处理');
					});
				},
				//获取动态
				getLaterDynamic(index) {
					this.tempIndex = index
					this.$http.get('/user/getDynamicByUserID/',
					{params:{time:new Date().getTime(),userID:this.userID}},
					{header:{cookie:this.ticket}})
					.then(function(res) {
						this.toLoginView(res)
						this.dynamics.data = res.body.data
					},function() {
						console.log('请求失败处理');
					});
				},
				//获取发送的礼物
				getSendGiftOrder(index) {
					this.tempIndex = index
					this.$http.get('/user/getSendGiftOrder/',
					{params:{time:new Date().getTime()}},
					{header:{cookie:this.ticket}})
					.then(function(res) {
						this.toLoginView(res)
						this.sendGiftOrder = res.body.data
					},function() {
						console.log('请求失败处理');
					});
				},
				//获取接受的礼物
				getTakeGiftOrder(index) {
					this.tempIndex = index
					this.$http.get('/user/getTakeGiftOrder/',
					{params:{time:new Date().getTime()}},
					{header:{cookie:this.ticket}})
					.then(function(res) {
						this.toLoginView(res)
						this.takeGiftOrder = res.body.data
					},function() {
						console.log('请求失败处理');
					});
				},
				//跳转到登录页面
				toLoginView(res) {
					if(res.body.code == "302") {
						window.location.href = "login.html"
					}
				},
				logout(){
					this.$http.get('/user/logout/',
						{params : {time:new Date().getTime()}})
					.then(function(res) {
						window.location.href = "login.html"
					},function() {
						console.log('请求失败处理');
					});
				},
				change() {
					if(this.languageID == 1) {
						this.topLabel = ["个人资料", "消息", "退出"]
						this.leftLabel = ["升级", "充值", "金币", "生日", "教育", "身高", "体重", "工作", "国家", "地区"]
						this.rightLabel = ["动态", "发送的礼物", "接受的礼物"]
						this.formLabel = ["选择图片", "发布"]
					} else if(this.languageID == 2) {
						this.topLabel = ["個人資料", "消息", "退出"]
						this.leftLabel = ["升级", "充值", "金幣", "生日", "教育", "身高", "體重", "工作", "國家", "地區"]
						this.rightLabel = ["動態", "發送的禮物", "接受的禮物"]
						this.formLabel = ["選擇圖片", "發布"]
					} else if(this.languageID == 3) {
						this.topLabel = ["personal data", "message", "log out"]
						this.leftLabel = ["upgrade", "top up", "gold", "birthday", "education", "height", "weight", "job", "country", "city"]
						this.rightLabel = ["dynamic state", "The gift sent", "Received gift"]
						this.formLabel = ["select image", "publish"]
					} else if(this.languageID == 4) {
						this.topLabel = ["인적 사항", "소식.정보.", "퇴출"]
						this.leftLabel = ["승급하다", "충전시키다", "잔액", "생일", "교육", "신장", "체중", "직업", "국가", "지역"]
						this.rightLabel = ["동태", "선물 꾸러미", "선물을 받다"]
						this.formLabel = ["그림 선택", "발포하다"]
					} else if(this.languageID == 5) {
						this.topLabel = ["个人资料", "しょうそく", "たいしゅつ"]
						this.leftLabel = ["進級する", "[リチャージ", "やまぶき", "生まれた日", "きょういく", "身長", "たいじゅう", "こうさく", "こっか", "ちく"]
						this.rightLabel = ["うごき", "送られたプレゼント", "受け取った贈り物"]
						this.formLabel = ["画像を選択する", "敷いた"]
					} else if(this.languageID == 6) {
						this.topLabel = ["ข้อมูลส่วนบุคคล", "ข่าว", "ออก"]
						this.leftLabel = ["อัพ เกรด", "ชาร์จ", "ทอง", "วัน", "ศึกษา", "สูง", "น้ำหนัก", "งาน", "ประเทศ", "ตั้ง"]
						this.rightLabel = ["แบบ ไดนามิก", "ของขวัญที่ส่ง", "ของขวัญที่ยอมรับ"]
						this.formLabel = ["เลือกรูปภาพ", "วาง จำหน่าย"]
					}
				},
				getUrlQuery() {
					var query = window.location.search.substring(1)
					var vars = query.split("?")
					var pairs = vars[0].split("=")
					this.userID = pairs[1]
				}
			},
			beforeMount() {
				this.checkTicket()
				this.getUrlQuery()
				this.getUserInfo()
				this.getThreadUser()
				this.getLaterDynamic(1)
			}
		})
	</script>
</html>
